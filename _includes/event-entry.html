{% assign event = include.event %}
{% capture event_id %}{{ event.date | date: '%y%m%d' }}-{{ event.title | slugify }}{% endcapture %}

<div class="mb-4 event-item event-{{ event.tag | downcase | default: 'other' }}" id="{{ event_id }}">
  <div class="event-flex">
    <div class="event-main">
      <h4 class="event-title">
        {% if event.link %}
          <a href="{{ event.link }}">{{ event.title }}</a>
        {% else %}
          {{ event.title }}
        {% endif %}
        {% if event.who %}
          {% if event.wholink %}
            <a href="{{ event.wholink }}" class="me-2"><span class="who">{{ event.who }}</span> </a>
          {% else %}
            <span class="who">{{ event.who }}</span>
          {% endif %}
        {% endif %}
        {% if event.tag %}
          <span class="event-tag event-tag--{{ event.tag | downcase }}">
            {{ event.tag }}
          </span>
        {% endif %}
      </h4>
      <p class="text-muted">
        <span>{{ event.time }}  {{ event.date | date: "%B %d, %Y" }}</span>
        <span style="margin-left: 2em">{{ event.where }}</span>
        <a class="event-link-anchor" href="{{ include.page_url | relative_url }}#{{ event_id }}" aria-label="Link to this event" title="Link to this event">ðŸ”—</a>
      </p>

      {% if include.is_past %}
        {% if event.description | strip != "tba" or event.bio %}
          <div class="event-body clamped">
            {% if event.description | strip != "tba" %}
              <div class="markdown-content">
                {{ event.description | markdownify }}
              </div>
            {% endif %}
            {% if event.bio %}
              <p>{{ event.bio | markdownify }}</p>
            {% endif %}
          </div>
          <button class="expand-btn">See more</button>
        {% endif %}
      {% else %}
        {% if event.description | strip != "tba" %}
          <div class="markdown-content">
            {{ event.description | markdownify }}
          </div>
        {% endif %}
        {% if event.bio %}
          <p>{{ event.bio | markdownify }}</p>
        {% endif %}
      {% endif %}

      <div class="mt-4">
        {% if event.video %}
        <a href="{{ event.video }}" class="btn btn-primary rounded-pill px-3 py-1" style="text-decoration: none; font-weight: 500;">
          <i class="fas fa-play-circle me-2">Video Recording</i>
        </a>
        {% endif %}
        {% if event.slides %}
        <a href="{{ event.slides }}" class="btn btn-primary rounded-pill px-3 py-1" style="text-decoration: none; font-weight: 500;">
          <i class="fas fa-file-alt me-2">Slides</i>
        </a>
        {% endif %}
      </div>
    </div>

    {% if event.image %}
      {% assign img = event.image %}
      {% if img contains '://' %}
        {% assign img_url = img %}
      {% else %}
        {% assign img_url = img | relative_url %}
      {% endif %}
      <div class="event-media">
        <img src="{{ img_url }}" alt="{{ event.title | escape }}" loading="lazy">
      </div>
    {% endif %}
  </div>
</div>
